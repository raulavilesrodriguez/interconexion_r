)))==0, "troncalizado", ifelse(espacial_con !=0 & rowSums(across(c(
sai_con, portador_con, stf_con, avs_con, sma_con, satelite_con, tronc_con
)))==0, "espacial", ifelse(satelite_con !=0 & rowSums(across(c(
sai_con, portador_con, stf_con, avs_con, sma_con, tronc_con, espacial_con
)))==0, "satelital", "")))))
costos_gastos[2,6]
costos_gastos[2,5]
View(costos_gastos)
costos_gastos[4,5]
costos_gastos[4,6]
costos_gastos[4,6] + costos_gastos[4, 7]
costos_gastos <- costos_gastos |>
mutate(con_total = ifelse(sai_con >= portador_con, rowSums(across(c(
sai_con, stf_con, avs_con, sma_con, tronc_con, satelite_con, espacial_con
))), rowSums(across(c(
portador_con, stf_con, avs_con, sma_con, tronc_con, satelite_con, espacial_con
)))),
costo_usuario = `7999`/(con_total*12),
income_usuarios = `1005`/(con_total*12),
profit = income_usuarios - costo_usuario) |>
filter(costo_usuario != Inf & !is.na(costo_usuario)) |>
mutate(servicio = ifelse(sai_con !=0 || portador_con !=0 & rowSums(across(c(
stf_con, avs_con, sma_con, tronc_con, satelite_con, espacial_con
)))==0, "sai_portador", ifelse(tronc_con !=0 & rowSums(across(c(
sai_con, portador_con, stf_con, avs_con, sma_con, satelite_con, espacial_con
)))==0, "troncalizado", ifelse(espacial_con !=0 & rowSums(across(c(
sai_con, portador_con, stf_con, avs_con, sma_con, satelite_con, tronc_con
)))==0, "espacial", ifelse(satelite_con !=0 & rowSums(across(c(
sai_con, portador_con, stf_con, avs_con, sma_con, tronc_con, espacial_con
)))==0, "satelital", "")))))
costos_gastos <- costos_gastos |>
mutate(con_total = ifelse(sai_con >= portador_con, rowSums(across(c(
sai_con, stf_con, avs_con, sma_con, tronc_con, satelite_con, espacial_con
))), rowSums(across(c(
portador_con, stf_con, avs_con, sma_con, tronc_con, satelite_con, espacial_con
)))),
costo_usuario = `7999`/(con_total*12),
income_usuarios = `1005`/(con_total*12),
profit = income_usuarios - costo_usuario) |>
filter(costo_usuario != Inf & !is.na(costo_usuario)) |>
mutate(servicio = ifelse(sai_con !=0 & rowSums(across(c(
stf_con, avs_con, sma_con, tronc_con, satelite_con, espacial_con
)))==0, "sai_portador", ifelse(tronc_con !=0 & rowSums(across(c(
sai_con, portador_con, stf_con, avs_con, sma_con, satelite_con, espacial_con
)))==0, "troncalizado", ifelse(espacial_con !=0 & rowSums(across(c(
sai_con, portador_con, stf_con, avs_con, sma_con, satelite_con, tronc_con
)))==0, "espacial", ifelse(satelite_con !=0 & rowSums(across(c(
sai_con, portador_con, stf_con, avs_con, sma_con, tronc_con, espacial_con
)))==0, "satelital", "")))))
costos_gastos <- costos_gastos |>
mutate(con_total = ifelse(sai_con >= portador_con, rowSums(across(c(
sai_con, stf_con, avs_con, sma_con, tronc_con, satelite_con, espacial_con
))), rowSums(across(c(
portador_con, stf_con, avs_con, sma_con, tronc_con, satelite_con, espacial_con
)))),
costo_usuario = `7999`/(con_total*12),
income_usuarios = `1005`/(con_total*12),
profit = income_usuarios - costo_usuario) |>
filter(costo_usuario != Inf & !is.na(costo_usuario)) |>
mutate(servicio = ifelse(sai_con + portador_con !=0 & rowSums(across(c(
stf_con, avs_con, sma_con, tronc_con, satelite_con, espacial_con
)))==0, "sai_portador", ifelse(tronc_con !=0 & rowSums(across(c(
sai_con, portador_con, stf_con, avs_con, sma_con, satelite_con, espacial_con
)))==0, "troncalizado", ifelse(espacial_con !=0 & rowSums(across(c(
sai_con, portador_con, stf_con, avs_con, sma_con, satelite_con, tronc_con
)))==0, "espacial", ifelse(satelite_con !=0 & rowSums(across(c(
sai_con, portador_con, stf_con, avs_con, sma_con, tronc_con, espacial_con
)))==0, "satelital", "")))))
costos_gastos <- costos_gastos |>
mutate(con_total = ifelse(sai_con >= portador_con, rowSums(across(c(
sai_con, stf_con, avs_con, sma_con, tronc_con, satelite_con, espacial_con
))), rowSums(across(c(
portador_con, stf_con, avs_con, sma_con, tronc_con, satelite_con, espacial_con
)))),
costo_usuario = `7999`/(con_total*12),
income_usuarios = `1005`/(con_total*12),
profit = income_usuarios - costo_usuario) |>
filter(costo_usuario != Inf & !is.na(costo_usuario)) |>
mutate(servicio = ifelse(sai_con + portador_con !=0 & rowSums(across(c(
stf_con, avs_con, sma_con, tronc_con, satelite_con, espacial_con
)))==0, "sai_portador", ifelse(tronc_con !=0 & rowSums(across(c(
sai_con, portador_con, stf_con, avs_con, sma_con, satelite_con, espacial_con
)))==0, "troncalizado", ifelse(espacial_con !=0 & rowSums(across(c(
sai_con, portador_con, stf_con, avs_con, sma_con, satelite_con, tronc_con
)))==0, "espacial", ifelse(satelite_con !=0 & rowSums(across(c(
sai_con, portador_con, stf_con, avs_con, sma_con, tronc_con, espacial_con
)))==0, "satelital", ifelse(avs_con !=0 & rowSums(across(c(
sai_con, portador_con, stf_con, espacial_con, sma_con, satelite_con, tronc_con
)))==0, "avs", ""))))))
View(costos_gastos)
costos_gastos <- costos_gastos |>
mutate(con_total = ifelse(sai_con >= portador_con, rowSums(across(c(
sai_con, stf_con, avs_con, sma_con, tronc_con, satelite_con, espacial_con
))), rowSums(across(c(
portador_con, stf_con, avs_con, sma_con, tronc_con, satelite_con, espacial_con
)))),
costo_usuario = `7999`/(con_total*12),
income_usuarios = `1005`/(con_total*12),
profit = income_usuarios - costo_usuario) |>
filter(costo_usuario != Inf & !is.na(costo_usuario)) |>
mutate(servicio = ifelse(sai_con + portador_con !=0 & rowSums(across(c(
stf_con, avs_con, sma_con, tronc_con, satelite_con, espacial_con
)))==0, "sai_portador", ifelse(tronc_con !=0 & rowSums(across(c(
sai_con, portador_con, stf_con, avs_con, sma_con, satelite_con, espacial_con
)))==0, "troncalizado", ifelse(espacial_con !=0 & rowSums(across(c(
sai_con, portador_con, stf_con, avs_con, sma_con, satelite_con, tronc_con
)))==0, "espacial", ifelse(satelite_con !=0 & rowSums(across(c(
sai_con, portador_con, stf_con, avs_con, sma_con, tronc_con, espacial_con
)))==0, "satelital", ifelse(avs_con !=0 & rowSums(across(c(
sai_con, portador_con, stf_con, espacial_con, sma_con, satelite_con, tronc_con
)))==0, "avs", ifelse(stf_con !=0 & rowSums(across(c(
sai_con, portador_con, avs_con, sma_con, tronc_con, espacial_con, satelite_con
)))==0, "fija", "multiservicios")))))))
costos_gastos |> mutate(NOMBRE = (reorder(NOMBRE, -costo_usuario))) |>
ggplot(aes(NOMBRE, costo_usuario)) + geom_col(position = "dodge", width=0.9, fill=servicio, color = "black") +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
ylab("Costos y Gastos") + xlab("") +
facet_wrap(~servicio, ncol = 2, scales = "free_x")
costos_gastos$servicio
#Plot bars
costos_gastos |> mutate(NOMBRE = (reorder(NOMBRE, -costo_usuario))) |>
ggplot(aes(NOMBRE, costo_usuario)) + geom_col(position = "dodge", width=0.9, fill=servicio, color = "black") +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
ylab("Costos y Gastos") + xlab("") +
facet_wrap(~servicio, ncol = 2, scales = "free_x")
source("C:/Users/bravi/projects/interconexion_r/impact_itx.R", echo=TRUE)
#Plot bars
costos_gastos |> mutate(NOMBRE = (reorder(NOMBRE, -costo_usuario))) |>
ggplot(aes(NOMBRE, costo_usuario, fill=servicio)) + geom_col(position = "dodge", width=0.9, color = "black") +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
ylab("Costos y Gastos") + xlab("") +
facet_wrap(~servicio, ncol = 2, scales = "free_x")
#Plot bars
costos_gastos |> mutate(NOMBRE = (reorder(NOMBRE, -costo_usuario))) |>
ggplot(aes(NOMBRE, costo_usuario, fill=servicio)) + geom_col(position = "dodge", width=0.9, color = "black") +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
ylab("Costos y Gastos") + xlab("") +
facet_wrap(~servicio, ncol = 1, scales = "free_x")
costos_gastos |> mutate(NOMBRE = (reorder(NOMBRE, -costo_usuario))) |>
ggplot(aes(NOMBRE, costo_usuario, fill=servicio)) + geom_col(show.legend = FALSE) +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
ylab("Costos y Gastos") + xlab("") +
facet_wrap(~servicio, ncol = 1, scales = "free_x")
#Plot bars
costos_gastos |> slice_max(costo_usuario, n = 5) |> mutate(NOMBRE = (reorder(NOMBRE, -costo_usuario))) |>
ggplot(aes(NOMBRE, costo_usuario, fill=servicio)) + geom_col(show.legend = FALSE) +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
ylab("Costos y Gastos") + xlab("") +
facet_wrap(~servicio, ncol = 1, scales = "free_x")
#Plot bars
costos_gastos |> slice_max(costo_usuario, n = 5) |> mutate(NOMBRE = (reorder(NOMBRE, -costo_usuario))) |>
ggplot(aes(NOMBRE, costo_usuario)) + geom_col(show.legend = FALSE) +
ylab("Costos y Gastos") + xlab("") +
facet_wrap(~servicio, ncol = 1, scales = "free_x")
costos_gastos |> slice_max(costo_usuario, n = 5) |> mutate(NOMBRE = (reorder(NOMBRE, -costo_usuario))) |>
ggplot(aes(NOMBRE, costo_usuario)) + geom_col(show.legend = FALSE) +
ylab("Costos y Gastos") + xlab("") +
facet_wrap(~servicio, ncol = 2, scales = "free_x")
#Plot bars
costos_gastos |> slice_max(costo_usuario, n = 15) |> mutate(NOMBRE = (reorder(NOMBRE, -costo_usuario))) |>
ggplot(aes(NOMBRE, costo_usuario, fill=servicio)) + geom_col(show.legend = FALSE) +
ylab("Costos y Gastos") + xlab("") +
facet_wrap(~servicio, ncol = 2, scales = "free_x")
#Plot bars
costos_gastos |> slice_max(costo_usuario, n = 5) |> mutate(NOMBRE = (reorder(NOMBRE, -costo_usuario))) |>
ggplot(aes(NOMBRE, costo_usuario, fill=servicio)) + geom_col(show.legend = FALSE) +
ylab("Costos y Gastos") + xlab("") +
facet_wrap(~servicio, ncol = 2, scales = "free_x")
#Plot bars
costos_gastos |> slice_max(costo_usuario, n = 5) |> mutate(NOMBRE = (reorder(NOMBRE, -costo_usuario))) |>
ggplot(aes(costo_usuario, fill=servicio)) + geom_col(show.legend = FALSE) +
ylab("Costos y Gastos") + xlab("") +
facet_wrap(~servicio, ncol = 2, scales = "free_x")
#Plot bars
costos_gastos |> slice_max(costo_usuario, n = 5) |> mutate(NOMBRE = (reorder(NOMBRE, -costo_usuario))) |>
ggplot(aes(NOMBRE, costo_usuario, fill=servicio)) + geom_col(show.legend = FALSE) +
facet_wrap(~servicio, ncol = 2, scales = "free_x")
#Plot bars
costos_gastos |> slice_max(costo_usuario, n = 20) |> mutate(NOMBRE = (reorder(NOMBRE, -costo_usuario))) |>
ggplot(aes(NOMBRE, costo_usuario, fill=servicio)) + geom_col(show.legend = FALSE) +
facet_wrap(~servicio, ncol = 2, scales = "free_x")
costos_gastos |> slice_max(costo_usuario, n = 200) |> mutate(NOMBRE = (reorder(NOMBRE, -costo_usuario))) |>
ggplot(aes(NOMBRE, costo_usuario, fill=servicio)) + geom_col(show.legend = FALSE) +
facet_wrap(~servicio, ncol = 2, scales = "free_x")
costos_gastos |> mutate(NOMBRE = (reorder(NOMBRE, -costo_usuario))) |>
ggplot(aes(NOMBRE, costo_usuario, fill=servicio)) + geom_col(show.legend = FALSE) +
facet_wrap(~servicio, ncol = 2, scales = "free_x")
#Plot bars
costos_gastos |> mutate(NOMBRE = (reorder(NOMBRE, -costo_usuario))) |>
ggplot(aes(NOMBRE, costo_usuario, fill=servicio)) + geom_col(show.legend = FALSE) +
facet_wrap(~servicio, ncol = 1, scales = "free_x")
source("C:/Users/bravi/projects/interconexion_r/impact_itx.R", echo=TRUE)
#Plot bars
costos_gastos |> filter(servicio == 'sai_portador') |> mutate(NOMBRE = (reorder(NOMBRE, -costo_usuario))) |>
mutate(NOMBRE = (reorder(NOMBRE, -costo_usuario))) |>
ggplot(aes(NOMBRE, costo_usuario)) + geom_col(show.legend = FALSE) +
geom_col(position = "dodge", width=0.9, fill="#0E8388", color = "black") +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
ylab("Costos y Gastos") + xlab("")
costos_gastos <- costos_gastos |>
mutate(con_total = ifelse(sai_con >= portador_con, rowSums(across(c(
sai_con, stf_con, avs_con, sma_con, tronc_con, satelite_con, espacial_con
))), rowSums(across(c(
portador_con, stf_con, avs_con, sma_con, tronc_con, satelite_con, espacial_con
)))),
costo_usuario = `7999`/(con_total*12),
income_usuarios = `1005`/(con_total*12),
profit = income_usuarios - costo_usuario) |>
filter(costo_usuario != Inf & !is.na(costo_usuario)) |>
mutate(servicio = ifelse(sai_con != 0 & portador_con !=0 & rowSums(across(c(
stf_con, avs_con, sma_con, tronc_con, satelite_con, espacial_con
)))==0, "sai_portador", ifelse(tronc_con !=0 & rowSums(across(c(
sai_con, portador_con, stf_con, avs_con, sma_con, satelite_con, espacial_con
)))==0, "troncalizado", ifelse(espacial_con !=0 & rowSums(across(c(
sai_con, portador_con, stf_con, avs_con, sma_con, satelite_con, tronc_con
)))==0, "espacial", ifelse(satelite_con !=0 & rowSums(across(c(
sai_con, portador_con, stf_con, avs_con, sma_con, tronc_con, espacial_con
)))==0, "satelital", ifelse(avs_con !=0 & rowSums(across(c(
sai_con, portador_con, stf_con, espacial_con, sma_con, satelite_con, tronc_con
)))==0, "avs", ifelse(stf_con !=0 & rowSums(across(c(
sai_con, portador_con, avs_con, sma_con, tronc_con, espacial_con, satelite_con
)))==0, "fija", "multiservicios")))))))
#Plot bars
costos_gastos |> filter(servicio == 'sai_portador') |> mutate(NOMBRE = (reorder(NOMBRE, -costo_usuario))) |>
mutate(NOMBRE = (reorder(NOMBRE, -costo_usuario))) |>
ggplot(aes(NOMBRE, costo_usuario)) + geom_col(show.legend = FALSE) +
geom_col(position = "dodge", width=0.9, fill="#0E8388", color = "black") +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
ylab("Costos y Gastos") + xlab("")
costos_gastos <- costos_gastos |>
mutate(con_total = ifelse(sai_con >= portador_con, rowSums(across(c(
sai_con, stf_con, avs_con, sma_con, tronc_con, satelite_con, espacial_con
))), rowSums(across(c(
portador_con, stf_con, avs_con, sma_con, tronc_con, satelite_con, espacial_con
)))),
costo_usuario = `7999`/(con_total*12),
income_usuarios = `1005`/(con_total*12),
profit = income_usuarios - costo_usuario) |>
filter(costo_usuario != Inf & !is.na(costo_usuario)) |>
mutate(servicio = ifelse(sai_con != 0 & rowSums(across(c(
stf_con, avs_con, sma_con, tronc_con, satelite_con, espacial_con
)))==0, "sai_portador", ifelse(tronc_con !=0 & rowSums(across(c(
sai_con, portador_con, stf_con, avs_con, sma_con, satelite_con, espacial_con
)))==0, "troncalizado", ifelse(espacial_con !=0 & rowSums(across(c(
sai_con, portador_con, stf_con, avs_con, sma_con, satelite_con, tronc_con
)))==0, "espacial", ifelse(satelite_con !=0 & rowSums(across(c(
sai_con, portador_con, stf_con, avs_con, sma_con, tronc_con, espacial_con
)))==0, "satelital", ifelse(avs_con !=0 & rowSums(across(c(
sai_con, portador_con, stf_con, espacial_con, sma_con, satelite_con, tronc_con
)))==0, "avs", ifelse(stf_con !=0 & rowSums(across(c(
sai_con, portador_con, avs_con, sma_con, tronc_con, espacial_con, satelite_con
)))==0, "fija", "multiservicios")))))))
#Plot bars
costos_gastos |> filter(servicio == 'sai_portador') |> mutate(NOMBRE = (reorder(NOMBRE, -costo_usuario))) |>
mutate(NOMBRE = (reorder(NOMBRE, -costo_usuario))) |>
ggplot(aes(NOMBRE, costo_usuario)) + geom_col(show.legend = FALSE) +
geom_col(position = "dodge", width=0.9, fill="#0E8388", color = "black") +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
ylab("Costos y Gastos") + xlab("")
#Plot bars
costos_gastos |> filter(servicio == 'sai_portador') |> mutate(NOMBRE = (reorder(NOMBRE, -costo_usuario))) |>
mutate(NOMBRE = (reorder(NOMBRE, costo_usuario))) |>
ggplot(aes(NOMBRE, costo_usuario)) + geom_col(show.legend = FALSE) +
geom_col(position = "dodge", width=0.9, fill="#0E8388", color = "black") +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
ylab("Costos y Gastos") + xlab("")
#Plot bars
costos_gastos |> filter(servicio == 'sai_portador') |> mutate(NOMBRE = (reorder(NOMBRE, -costo_usuario))) |>
mutate(NOMBRE = (reorder(NOMBRE, costo_usuario))) |>
ggplot(aes(NOMBRE, costo_usuario)) + geom_col(show.legend = FALSE) +
geom_col(position = "dodge", width=0.9, fill="#0E8388", color = "black") +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
ylab("Costo_Conexión") + xlab("")
costos_gastos <- costos_gastos |>
mutate(con_total = ifelse(sai_con >= portador_con, rowSums(across(c(
sai_con, stf_con, avs_con, sma_con, tronc_con, satelite_con, espacial_con
))), rowSums(across(c(
portador_con, stf_con, avs_con, sma_con, tronc_con, satelite_con, espacial_con
)))),
costo_usuario = `7999`/(con_total*12),
income_usuarios = `1005`/(con_total*12),
profit = income_usuarios - costo_usuario) |>
filter(costo_usuario != Inf & !is.na(costo_usuario)) |>
mutate(servicio = ifelse(sai_con != 0 & rowSums(across(c(
stf_con, avs_con, sma_con, tronc_con, satelite_con, espacial_con
)))==0, "sai_portador", ifelse(tronc_con !=0 & rowSums(across(c(
sai_con, portador_con, stf_con, avs_con, sma_con, satelite_con, espacial_con
)))==0, "troncalizado", ifelse(espacial_con !=0 & rowSums(across(c(
sai_con, portador_con, stf_con, avs_con, sma_con, satelite_con, tronc_con
)))==0, "espacial", ifelse(satelite_con !=0 & rowSums(across(c(
sai_con, portador_con, stf_con, avs_con, sma_con, tronc_con, espacial_con
)))==0, "satelital", ifelse(avs_con !=0 & rowSums(across(c(
sai_con, portador_con, stf_con, espacial_con, sma_con, satelite_con, tronc_con
)))==0, "avs", ifelse(stf_con !=0 & rowSums(across(c(
sai_con, portador_con, avs_con, sma_con, tronc_con, espacial_con, satelite_con
)))==0, "fija", ifelse(portador_con != 0 & rowSums(across(c(
sai_con, stf_con, avs_con, espacial_con, sma_con, satelite_con, tronc_con
)))==0, 'portador', 'multiservicios'))))))))
#Plot bars
costos_gastos |> filter(servicio == 'sai_portador') |> mutate(NOMBRE = (reorder(NOMBRE, -costo_usuario))) |>
mutate(NOMBRE = (reorder(NOMBRE, costo_usuario))) |>
ggplot(aes(NOMBRE, costo_usuario)) + geom_col(show.legend = FALSE) +
geom_col(position = "dodge", width=0.9, fill="#0E8388", color = "black") +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
ylab("Costo_Conexión") + xlab("")
costos_gastos <- costos_gastos |>
mutate(con_total = ifelse(sai_con >= portador_con, rowSums(across(c(
sai_con, stf_con, avs_con, sma_con, tronc_con, satelite_con, espacial_con
))), rowSums(across(c(
portador_con, stf_con, avs_con, sma_con, tronc_con, satelite_con, espacial_con
)))),
costo_usuario = `7999`/(con_total*12),
income_usuarios = `1005`/(con_total*12),
profit = income_usuarios - costo_usuario) |>
filter(costo_usuario != Inf & !is.na(costo_usuario)) |>
mutate(servicio = ifelse(sai_con != 0 & rowSums(across(c(
stf_con, avs_con, sma_con, tronc_con, satelite_con, espacial_con
)))==0, "sai_portador", ifelse(tronc_con !=0 & rowSums(across(c(
sai_con, portador_con, stf_con, avs_con, sma_con, satelite_con, espacial_con
)))==0, "troncalizado", ifelse(espacial_con !=0 & rowSums(across(c(
sai_con, portador_con, stf_con, avs_con, sma_con, satelite_con, tronc_con
)))==0, "espacial", ifelse(satelite_con !=0 & rowSums(across(c(
sai_con, portador_con, stf_con, avs_con, sma_con, tronc_con, espacial_con
)))==0, "satelital", ifelse(avs_con !=0 & rowSums(across(c(
sai_con, portador_con, stf_con, espacial_con, sma_con, satelite_con, tronc_con
)))==0, "avs", ifelse(stf_con !=0 & rowSums(across(c(
sai_con, portador_con, avs_con, sma_con, tronc_con, espacial_con, satelite_con
)))==0, "fija", ifelse(portador_con != 0 & rowSums(across(c(
sai_con, stf_con, avs_con, espacial_con, sma_con, satelite_con, tronc_con
)))==0, 'portador', 'multiservicios'))))))))
#Plot bars
costos_gastos |> mutate(NOMBRE = (reorder(NOMBRE, -costo_usuario))) |>
mutate(NOMBRE = (reorder(NOMBRE, costo_usuario))) |>
ggplot(aes(NOMBRE, costo_usuario)) + geom_col(show.legend = FALSE) +
geom_col(position = "dodge", width=0.9, fill="#0E8388", color = "black") +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
ylab("Costo_Conexión") + xlab("")
#Plot bars
costos_gastos |> mutate(NOMBRE = (reorder(NOMBRE, -costo_usuario))) |>
slice_max(costo_usuario, n = 15) |>
mutate(NOMBRE = (reorder(NOMBRE, costo_usuario))) |>
ggplot(aes(NOMBRE, costo_usuario)) + geom_col(show.legend = FALSE) +
geom_col(position = "dodge", width=0.9, fill="#0E8388", color = "black") +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
ylab("Costo_Conexión") + xlab("")
#Plot bars
costos_gastos |> mutate(NOMBRE = (reorder(NOMBRE, -costo_usuario))) |>
slice_max(costo_usuario, n = 15) |>
mutate(NOMBRE = (reorder(NOMBRE, costo_usuario))) |>
ggplot(aes(NOMBRE, costo_usuario, fill = servicio)) + geom_col(show.legend = FALSE) +
geom_col(position = "dodge", width=0.9, color = "black") +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
ylab("Costo_Conexión") + xlab("")
#Plot bars
costos_gastos |> mutate(NOMBRE = (reorder(NOMBRE, -costo_usuario))) |>
slice_min(costo_usuario, n = 15) |>
mutate(NOMBRE = (reorder(NOMBRE, costo_usuario))) |>
ggplot(aes(NOMBRE, costo_usuario, fill = servicio)) + geom_col(show.legend = FALSE) +
geom_col(position = "dodge", width=0.9, color = "black") +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
ylab("Costo_Conexión") + xlab("")
costos_gastos |> filter(servicio == "multiservicios" ) |>
summarise(mean_costo_u = mean(costo_usuario),
mean_income_u = mean(income_usuarios))
#|>arrange(desc(sai_con)) |>
costos_gastos |> filter(servicio == "multiservicios" ) |>
summarise(mean_costo_u = median(costo_usuario),
mean_income_u = median(income_usuarios))
costos_gastos <- costos_gastos |>
mutate(con_total = ifelse(sai_con >= portador_con, rowSums(across(c(
sai_con, stf_con, avs_con, sma_con, tronc_con, satelite_con, espacial_con
))), rowSums(across(c(
portador_con, stf_con, avs_con, sma_con, tronc_con, satelite_con, espacial_con
)))),
costo_usuario = `7999`/(con_total*12),
income_usuarios = `1005`/(con_total*12),
profit = income_usuarios - costo_usuario) |>
filter(costo_usuario != Inf & !is.na(costo_usuario)) |>
mutate(servicio = ifelse(sai_con != 0 & rowSums(across(c(
stf_con, avs_con, sma_con, tronc_con, satelite_con, espacial_con
)))==0, "sai", ifelse(tronc_con !=0 & rowSums(across(c(
sai_con, portador_con, stf_con, avs_con, sma_con, satelite_con, espacial_con
)))==0, "troncalizado", ifelse(espacial_con !=0 & rowSums(across(c(
sai_con, portador_con, stf_con, avs_con, sma_con, satelite_con, tronc_con
)))==0, "espacial", ifelse(satelite_con !=0 & rowSums(across(c(
sai_con, portador_con, stf_con, avs_con, sma_con, tronc_con, espacial_con
)))==0, "satelital", ifelse(avs_con !=0 & rowSums(across(c(
sai_con, portador_con, stf_con, espacial_con, sma_con, satelite_con, tronc_con
)))==0, "avs", ifelse(stf_con !=0 & rowSums(across(c(
sai_con, portador_con, avs_con, sma_con, tronc_con, espacial_con, satelite_con
)))==0, "fija", ifelse(portador_con != 0 & rowSums(across(c(
sai_con, stf_con, avs_con, espacial_con, sma_con, satelite_con, tronc_con
)))==0, 'portador', 'multiservicios'))))))))
#Plot bars
costos_gastos |> mutate(NOMBRE = (reorder(NOMBRE, -costo_usuario))) |>
slice_min(costo_usuario, n = 15) |>
mutate(NOMBRE = (reorder(NOMBRE, costo_usuario))) |>
ggplot(aes(NOMBRE, costo_usuario, fill = servicio)) + geom_col(show.legend = FALSE) +
geom_col(position = "dodge", width=0.9, color = "black") +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
ylab("Costo_Conexión") + xlab("")
costos_gastos |> filter(servicio == "multiservicios" ) |>
summarise(mean_costo_u = mean(costo_usuario),
mean_income_u = mean(income_usuarios))
#|>arrange(desc(sai_con)) |>
costos_gastos |> filter(servicio == "sai" ) |>
summarise(mean_costo_u = mean(costo_usuario),
mean_income_u = mean(income_usuarios))
#|>arrange(desc(sai_con)) |>
costos_gastos |> filter(servicio == "sai" ) |>
summarise(mean_costo_u = median(costo_usuario),
mean_income_u = median(income_usuarios))
#|>arrange(desc(sai_con)) |>
costos_gastos |> filter(servicio == "sai" ) |>
summarise(median_costo_u = median(costo_usuario),
median_income_u = median(income_usuarios))
#|>arrange(desc(sai_con)) |>
costos_gastos |> filter(servicio == "multiservicios" ) |>
summarise(median_costo_u = median(costo_usuario),
median_income_u = median(income_usuarios))
#|>arrange(desc(sai_con)) |>
costos_gastos |> filter(servicio == "avs" ) |>
summarise(median_costo_u = median(costo_usuario),
median_income_u = median(income_usuarios))
View(teleco_eeff)
#|>arrange(desc(sai_con)) |>
costos_gastos |> filter(servicio == "sai" ) |>
summarise(median_costo_u = median(costo_usuario),
median_income_u = median(income_usuarios))
costos_gastos |> select(costo_usuario) |> arrange(desc(costo_usuario)) |>
ggplot(aes(log10(costo_usuario))) + geom_density(fill="#94AF9F") +
labs(x = "Costos y gastos telco (normalizado)")
costos_gastos |> select(costo_usuario) |>
ggplot(aes(log10(costo_usuario))) + geom_density(fill="#94AF9F") +
labs(x = "Costos y gastos telco (normalizado)")
costos_gastos |>
ggplot(aes(log10(costo_usuario))) + geom_density(fill="#94AF9F") +
labs(x = "Costos y gastos telco (normalizado)")
meadian(costos_gastos$costo_usuario)
median(costos_gastos$costo_usuario)
median(costos_gastos$income_usuarios)
costos_gastos |>
ggplot(aes(log10(costo_usuario), fill = servicio)) + geom_density() +
facet_wrap(~servicio, ncol = 2, scales = "free_x")
labs(x = "Costos y gastos telco (normalizado)")
costos_gastos |> filter(servicio != "espacial") |>
ggplot(aes(log10(costo_usuario), fill = servicio)) + geom_density() +
facet_wrap(~servicio, ncol = 2, scales = "free_x")
labs(x = "Costos y gastos telco (normalizado)")
costos_gastos |> filter(servicio != "espacial") |>
ggplot(aes(log2(costo_usuario), fill = servicio)) + geom_density() +
facet_wrap(~servicio, ncol = 2, scales = "free_x")
labs(x = "Costos y gastos telco (normalizado)")
costos_gastos |> filter(servicio != "espacial") |>
ggplot(aes((costo_usuario), fill = servicio)) + geom_density() +
facet_wrap(~servicio, ncol = 2, scales = "free_x")
labs(x = "Costos y gastos telco (normalizado)")
View(costos_gastos)
costos_gastos |> filter(servicio != "espacial") |>
ggplot(aes(log10(costo_usuario), fill = servicio)) + geom_density() +
facet_wrap(~servicio, ncol = 2, scales = "free_x")
labs(x = "Costos y gastos telco (normalizado)")
costos_gastos |> filter(servicio == "sai" ) |>
summarise(median_costo_u = median(costo_usuario),
median_income_u = median(income_usuarios))
costos_gastos |> filter(servicio != "espacial") |>
ggplot(aes(log10(costo_usuario), fill = servicio)) + geom_density(alpha=.25) +
facet_wrap(~servicio, ncol = 2, scales = "free_x")
labs(x = "Costos y gastos telco (normalizado)")
costos_gastos |> filter(servicio == "sai" ) |>
summarise(median_costo_u = median(costo_usuario),
median_income_u = median(income_usuarios))
costos_gastos <- costos_gastos |>
mutate(con_total = ifelse(sai_con >= portador_con, rowSums(across(c(
sai_con, stf_con, avs_con, sma_con, tronc_con, satelite_con, espacial_con
))), rowSums(across(c(
portador_con, stf_con, avs_con, sma_con, tronc_con, satelite_con, espacial_con
)))),
costo_usuario = `7999`/(con_total*12),
income_usuarios = `1005`/(con_total*12),
profit = income_usuarios - costo_usuario) |>
filter(costo_usuario != Inf & !is.na(costo_usuario)) |>
mutate(servicio = ifelse(sai_con != 0 & rowSums(across(c(
stf_con, avs_con, sma_con, tronc_con, satelite_con, espacial_con
)))==0, "sai", ifelse(tronc_con !=0 & rowSums(across(c(
sai_con, portador_con, stf_con, avs_con, sma_con, satelite_con, espacial_con
)))==0, "troncalizado", ifelse(espacial_con !=0 & rowSums(across(c(
sai_con, portador_con, stf_con, avs_con, sma_con, satelite_con, tronc_con
)))==0, "espacial", ifelse(satelite_con !=0 & rowSums(across(c(
sai_con, portador_con, stf_con, avs_con, sma_con, tronc_con, espacial_con
)))==0, "satelital", ifelse(avs_con !=0 & rowSums(across(c(
sai_con, portador_con, stf_con, espacial_con, sma_con, satelite_con, tronc_con
)))==0, "avs", ifelse(stf_con !=0 & rowSums(across(c(
sai_con, portador_con, avs_con, sma_con, tronc_con, espacial_con, satelite_con
)))==0, "fija", ifelse(portador_con != 0 & rowSums(across(c(
sai_con, stf_con, avs_con, espacial_con, sma_con, satelite_con, tronc_con
)))==0, 'portador', 'sma_otros'))))))))
#Plot bars
costos_gastos |> mutate(NOMBRE = (reorder(NOMBRE, -costo_usuario))) |>
slice_min(costo_usuario, n = 15) |>
mutate(NOMBRE = (reorder(NOMBRE, costo_usuario))) |>
ggplot(aes(NOMBRE, costo_usuario, fill = servicio)) + geom_col(show.legend = FALSE) +
geom_col(position = "dodge", width=0.9, color = "black") +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
ylab("Costo_Conexión") + xlab("")
costos_gastos |> filter(servicio != "espacial") |>
ggplot(aes(log10(costo_usuario), fill = servicio)) + geom_density(alpha=.25) +
facet_wrap(~servicio, ncol = 2, scales = "free_x")
labs(x = "Costos y gastos telco (normalizado)")
costos_gastos |> filter(servicio == "sai" ) |>
summarise(median_costo_u = median(costo_usuario),
median_income_u = median(income_usuarios))
